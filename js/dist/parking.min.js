"use strict";var grid=document.getElementById("parkingGrid"),customSelect=document.getElementById("zoneSelect"),selected=customSelect.querySelector(".selected"),options=customSelect.querySelectorAll(".options li"),vehicleInfo=document.getElementById("vehicleInfo"),plateInfo=document.getElementById("plateInfo"),statusText=document.getElementById("status"),timerText=document.getElementById("timer"),priceText=document.getElementById("price"),zoneSelector=document.getElementById("zoneSelector"),freeCountEl=document.getElementById("freeCount"),busyCountEl=document.getElementById("busyCount"),vehicleImageEl=document.getElementById("vehicleImage"),currentZone="A",activeSlot=null,timerInterval=null,detectedPlate=null,currentVehicle="car",vehicleImages={car:"assets/vehicles/car.png",motorbike:"assets/vehicles/motorbike.png",bike:"assets/vehicles/bike.png"};function showNotification(e){var t=document.getElementById("systemNotification");document.getElementById("notifMessage").textContent=e,t.style.display="block"}function closeNotification(){document.getElementById("systemNotification").style.display="none"}function renderZoneButtons(){zoneSelector.innerHTML="",Object.keys(zones).forEach(function(e){var t=document.createElement("button");t.className="zone-btn",t.textContent=zones[e].name,e===currentZone&&t.classList.add("active"),t.onclick=function(){currentZone=e,renderZoneButtons(),renderSlots()},zoneSelector.appendChild(t)})}function updateZoneInfo(){var e=zones[currentZone].slots,t=0,n=0;e.forEach(function(e){return e.occupied?n++:t++}),freeCountEl.textContent=t,busyCountEl.textContent=n}function renderSlots(){grid.innerHTML="",zones[currentZone].slots.forEach(function(e){var t=document.createElement("div");t.className="slot "+(e.occupied?"busy":"free"),t.textContent="Slot ".concat(e.id),t.onclick=function(){return handleSlotClick(e)},grid.appendChild(t)}),updateZoneInfo()}function handleSlotClick(e){if(detectedPlate){var t=isVehicleAlreadyParked(detectedPlate);if(t)showNotification("Vehicle already parked!\nZone: ".concat(t.zone,"\nSlot: ").concat(t.slot));else{if(e.occupied){var n=Math.floor((Date.now()-e.startTime)/6e4),o=calculatePrice(n);showQRBill({zone:zones[currentZone].name,slot:e.id,vehicle:e.vehicle,plate:e.plate,time:n,price:o}),stopTimer(),e.occupied=!1,e.startTime=null,e.vehicle=null,e.plate=null,detectedPlate=null,vehicleInfo.textContent="Vehicle: —",plateInfo.textContent="Plate: —",statusText.textContent="Select a slot",vehicleImageEl.style.display="none",document.getElementById("plateText").textContent="—"}else{e.occupied=!0,e.startTime=Date.now(),e.vehicle=currentVehicle,e.plate=detectedPlate,activeSlot=e,vehicleInfo.textContent="Vehicle: ".concat(currentVehicle),plateInfo.textContent="Plate: ".concat(detectedPlate),statusText.textContent="Parking at ".concat(zones[currentZone].name," - Slot ").concat(e.id),vehicleImageEl.src=vehicleImages[currentVehicle],vehicleImageEl.style.display="block";isVehicleAlreadyParked(detectedPlate);startTimer()}renderSlots()}}else showNotification("Please scan vehicle plate first!")}function isVehicleAlreadyParked(e){for(var t in zones){var n=zones[t].slots,o=!0,c=!1,l=void 0;try{for(var a,r=n[Symbol.iterator]();!(o=(a=r.next()).done);o=!0){var i=a.value;if(i.occupied&&i.plate===e)return{zone:zones[t].name,slot:i.id}}}catch(e){c=!0,l=e}finally{try{o||null==r.return||r.return()}finally{if(c)throw l}}}return null}function startTimer(){clearInterval(timerInterval),timerInterval=setInterval(function(){if(activeSlot){var e=Math.floor((Date.now()-activeSlot.startTime)/1e3),t=String(Math.floor(e/60)).padStart(2,"0"),n=String(e%60).padStart(2,"0");timerText.textContent="Time: ".concat(t,":").concat(n),priceText.textContent="Price: ".concat(calculatePrice(Math.floor(e/60))," VND")}},1e3)}function stopTimer(){clearInterval(timerInterval),timerText.textContent="Time: 00:00",priceText.textContent="Price: 0 VND"}function openCamera(){detectedPlate=generatePlate(),document.getElementById("cameraModal").style.display="flex"}function generatePlate(){var e="ABCDEFGH",t=Math.floor(1e3+9e3*Math.random());return"51".concat(e[Math.floor(Math.random()*e.length)],"-").concat(t)}function confirmPlate(){document.getElementById("cameraModal").style.display="none",document.getElementById("plateText").textContent=detectedPlate}function showQRBill(e){var t=document.getElementById("qrModal"),n=document.getElementById("qrCode"),o=document.getElementById("billInfo");n.innerHTML="";var c="\nZone: ".concat(e.zone,"\nSlot: ").concat(e.slot,"\nVehicle: ").concat(e.vehicle,"\nPlate: ").concat(e.plate,"\nTime: ").concat(e.time," minutes\nPrice: ").concat(e.price," VND\n");new QRCode(n,{text:c,width:160,height:160}),o.innerText=c,t.style.display="flex"}function closeQR(){document.getElementById("qrModal").style.display="none"}document.querySelectorAll(".vehicle-option").forEach(function(e){e.onclick=function(){document.querySelectorAll(".vehicle-option").forEach(function(e){return e.classList.remove("active")}),e.classList.add("active"),currentVehicle=e.dataset.type}}),selected.onclick=function(){return customSelect.classList.toggle("open")},options.forEach(function(e){e.onclick=function(){currentZone=e.dataset.zone,selected.innerHTML=e.textContent+'<span class="arrow">▾</span>',customSelect.classList.remove("open"),stopTimer(),renderZoneButtons(),renderSlots()}}),document.addEventListener("click",function(e){customSelect.contains(e.target)||customSelect.classList.remove("open")}),document.getElementById("parkBtn").onclick=function(){return openCamera()},renderZoneButtons(),renderSlots();
//# sourceMappingURL=parking.min.js.map
