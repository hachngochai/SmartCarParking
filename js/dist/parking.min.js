"use strict";var grid=document.getElementById("parkingGrid"),customSelect=document.getElementById("zoneSelect"),selected=customSelect.querySelector(".selected"),options=customSelect.querySelectorAll(".options li"),vehicleInfo=document.getElementById("vehicleInfo"),plateInfo=document.getElementById("plateInfo"),statusText=document.getElementById("status"),timerText=document.getElementById("timer"),priceText=document.getElementById("price"),zoneSelector=document.getElementById("zoneSelector"),freeCountEl=document.getElementById("freeCount"),busyCountEl=document.getElementById("busyCount"),vehicleImageEl=document.getElementById("vehicleImage"),currentZone="A",activeSlot=null,timerInterval=null,detectedPlate=null,currentVehicle="car",pendingSlot=null,vehicleImages={car:"assets/vehicles/car.jpg",motorbike:"assets/vehicles/motorbike.jpg",bike:"assets/vehicles/bike.jpg"};function renderZoneButtons(){zoneSelector.innerHTML="",Object.keys(zones).forEach(function(e){var t=document.createElement("button");t.className="zone-btn",t.textContent=zones[e].name,e===currentZone&&t.classList.add("active"),t.onclick=function(){currentZone=e,renderZoneButtons(),renderSlots()},zoneSelector.appendChild(t)})}function updateZoneInfo(){var e=zones[currentZone].slots,t=0,n=0;e.forEach(function(e){return e.occupied?n++:t++}),freeCountEl.textContent=t,busyCountEl.textContent=n}function renderSlots(){grid.innerHTML="",zones[currentZone].slots.forEach(function(e){var t=document.createElement("div");t.className="slot "+(e.occupied?"busy":"free"),t.textContent="Slot ".concat(e.id),t.onclick=function(){return handleSlotClick(e)},grid.appendChild(t)}),updateZoneInfo()}function handleSlotClick(e){if(e.occupied)return pendingSlot=activeSlot=e,void(document.getElementById("confirmModal").style.display="flex");if(detectedPlate){var t=isVehicleAlreadyParked(detectedPlate);t?alert("Vehicle already parked!\nZone: ".concat(t.zone,"\nSlot: ").concat(t.slot)):(e.occupied=!0,e.startTime=Date.now(),e.vehicle=currentVehicle,e.plate=detectedPlate,activeSlot=e,vehicleInfo.textContent="Vehicle: ".concat(currentVehicle),plateInfo.textContent="Plate: ".concat(detectedPlate),statusText.textContent="Parking at ".concat(zones[currentZone].name," - Slot ").concat(e.id),vehicleImageEl.src=vehicleImages[currentVehicle],vehicleImageEl.style.display="block",startTimer(),detectedPlate=null,document.getElementById("plateText").textContent="—",renderSlots())}else alert("Please scan license plate first!")}function isVehicleAlreadyParked(e){for(var t in zones){var n=zones[t].slots,o=!0,l=!1,c=void 0;try{for(var r,a=n[Symbol.iterator]();!(o=(r=a.next()).done);o=!0){var i=r.value;if(i.occupied&&i.plate===e)return{zone:zones[t].name,slot:i.id}}}catch(e){l=!0,c=e}finally{try{o||null==a.return||a.return()}finally{if(l)throw c}}}return null}function startTimer(){clearInterval(timerInterval),timerInterval=setInterval(function(){if(activeSlot){var e=Math.floor((Date.now()-activeSlot.startTime)/1e3),t=String(Math.floor(e/60)).padStart(2,"0"),n=String(e%60).padStart(2,"0");timerText.textContent="Time: ".concat(t,":").concat(n),priceText.textContent="Price: ".concat(calculatePrice(Math.floor(e/60))," VND")}},1e3)}function stopTimer(){clearInterval(timerInterval),timerText.textContent="Time: 00:00",priceText.textContent="Price: 0 VND"}function openCamera(){detectedPlate=generatePlate(),document.getElementById("cameraModal").style.display="flex"}function generatePlate(){var e="ABCDEFGH",t=Math.floor(1e3+9e3*Math.random());return"51".concat(e[Math.floor(Math.random()*e.length)],"-").concat(t)}function confirmPlate(){document.getElementById("cameraModal").style.display="none",document.getElementById("plateText").textContent=detectedPlate}function showQRBill(e){var t=document.getElementById("qrModal"),n=document.getElementById("qrCode"),o=document.getElementById("billInfo");n.innerHTML="";var l="\n    Zone: ".concat(e.zone,"\n    Slot: ").concat(e.slot,"\n    Vehicle: ").concat(e.vehicle,"\n    Plate: ").concat(e.plate,"\n    Time: ").concat(e.time," minutes\n    Price: ").concat(e.price," VND\n    ");new QRCode(n,{text:l,width:160,height:160}),o.innerText=l,t.style.display="flex"}function closeQR(){document.getElementById("qrModal").style.display="none"}document.querySelectorAll(".vehicle-option").forEach(function(e){e.onclick=function(){document.querySelectorAll(".vehicle-option").forEach(function(e){return e.classList.remove("active")}),e.classList.add("active"),currentVehicle=e.dataset.type}}),selected.onclick=function(){return customSelect.classList.toggle("open")},options.forEach(function(e){e.onclick=function(){currentZone=e.dataset.zone,selected.innerHTML=e.textContent+'<span class="arrow">▾</span>',customSelect.classList.remove("open"),stopTimer(),renderZoneButtons(),renderSlots()}}),document.addEventListener("click",function(e){customSelect.contains(e.target)||customSelect.classList.remove("open")}),document.getElementById("parkBtn").onclick=function(){return openCamera()},document.getElementById("continueBtn").onclick=function(){document.getElementById("confirmModal").style.display="none",pendingSlot=null},document.getElementById("leaveBtn").onclick=function(){if(document.getElementById("confirmModal").style.display="none",pendingSlot){var e=Math.floor((Date.now()-pendingSlot.startTime)/6e4),t=calculatePrice(e);showQRBill({zone:zones[currentZone].name,slot:pendingSlot.id,vehicle:pendingSlot.vehicle,plate:pendingSlot.plate,time:e,price:t}),stopTimer(),pendingSlot.occupied=!1,pendingSlot.startTime=null,pendingSlot.vehicle=null,pendingSlot.plate=null,pendingSlot=activeSlot=null,vehicleInfo.textContent="Vehicle: —",plateInfo.textContent="Plate: —",statusText.textContent="Select a slot",vehicleImageEl.style.display="none",renderSlots()}},renderZoneButtons(),renderSlots();
//# sourceMappingURL=parking.min.js.map
