{"version":3,"sources":["parking.js"],"names":["grid","document","getElementById","customSelect","options","querySelectorAll","vehicleInfo","plateInfo","statusText","timerText","zoneSelector","freeCountEl","busyCountEl","vehicleImageEl","activeSlot","timerInterval","detectedPlate","currentVehicle","pendingSlot","motorbike","bike","btn","innerHTML","Object","zoneKey","zones","currentZone","createElement","onclick","name","renderSlots","classList","add","appendChild","renderZoneButtons","slots","updateZoneInfo","textContent","forEach","s","occupied","busy","free","div","slot","className","handleSlotClick","concat","id","style","display","existed","isVehicleAlreadyParked","alert","zone","startTime","Date","vehicle","plate","src","vehicleImages","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","err","option","remove","stopTimer","Math","floor","now","min","String","diff","padStart","sec","calculatePrice","startTimer","clearInterval","setInterval","priceText","openCamera","generatePlate","nums","random","letters","length","modal","qrDiv","billText","data","confirmPlate","time","price","QRCode","showQRBill","info","text","closeQR","opt","dataset","type","selected","toggle","addEventListener","e","contains","target","innerText","minutes"],"mappings":"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","file":"parking.min.js","sourcesContent":["/* ===================== DOM ===================== */\nconst grid = document.getElementById(\"parkingGrid\");\nconst customSelect = document.getElementById(\"zoneSelect\");\nconst selected = customSelect.querySelector(\".selected\");\nconst options = customSelect.querySelectorAll(\".options li\");\n\nconst vehicleInfo = document.getElementById(\"vehicleInfo\");\nconst plateInfo = document.getElementById(\"plateInfo\");\nconst statusText = document.getElementById(\"status\");\nconst timerText = document.getElementById(\"timer\");\nconst priceText = document.getElementById(\"price\");\n\nconst zoneSelector = document.getElementById(\"zoneSelector\");\nconst freeCountEl = document.getElementById(\"freeCount\");\nconst busyCountEl = document.getElementById(\"busyCount\");\n\nconst vehicleImageEl = document.getElementById(\"vehicleImage\");\n\n/* ===================== STATE ===================== */\nlet currentZone = \"A\";\nlet activeSlot = null;\nlet timerInterval = null;\nlet detectedPlate = null;\nlet currentVehicle = \"car\";\nlet pendingSlot = null;\n\n\n/* ===================== DATA ===================== */\nconst vehicleImages = {\n    car: \"assets/vehicles/car.jpg\",\n    motorbike: \"assets/vehicles/motorbike.jpg\",\n    bike: \"assets/vehicles/bike.jpg\"\n};\n\n/* ===================== VEHICLE SELECT ===================== */\ndocument.querySelectorAll(\".vehicle-option\").forEach(opt => {\n    opt.onclick = () => {\n        document\n            .querySelectorAll(\".vehicle-option\")\n            .forEach(o => o.classList.remove(\"active\"));\n\n        opt.classList.add(\"active\");\n        currentVehicle = opt.dataset.type;\n    };\n});\n\n/* ===================== ZONE ===================== */\nfunction renderZoneButtons() {\n    zoneSelector.innerHTML = \"\";\n\n    Object.keys(zones).forEach(zoneKey => {\n        const btn = document.createElement(\"button\");\n        btn.className = \"zone-btn\";\n        btn.textContent = zones[zoneKey].name;\n\n        if (zoneKey === currentZone) btn.classList.add(\"active\");\n\n        btn.onclick = () => {\n            currentZone = zoneKey;\n            renderZoneButtons();\n            renderSlots();\n        };\n\n        zoneSelector.appendChild(btn);\n    });\n}\n\nfunction updateZoneInfo() {\n    const slots = zones[currentZone].slots;\n    let free = 0, busy = 0;\n\n    slots.forEach(s => s.occupied ? busy++ : free++);\n\n    freeCountEl.textContent = free;\n    busyCountEl.textContent = busy;\n}\n\n/* ===================== PARKING GRID ===================== */\nfunction renderSlots() {\n    grid.innerHTML = \"\";\n    const slots = zones[currentZone].slots;\n\n    slots.forEach(slot => {\n        const div = document.createElement(\"div\");\n        div.className = \"slot \" + (slot.occupied ? \"busy\" : \"free\");\n        div.textContent = `Slot ${slot.id}`;\n        div.onclick = () => handleSlotClick(slot);\n        grid.appendChild(div);\n    });\n\n    updateZoneInfo();\n}\n\n/* ===================== SLOT CLICK ===================== */\n// \n\nfunction handleSlotClick(slot) {\n\n    /* ===== CLICK SLOT ÄÃƒ CÃ“ XE ===== */\n    if (slot.occupied) {\n\n        activeSlot = slot; // set láº¡i slot Ä‘ang thao tÃ¡c\n        pendingSlot = slot;\n\n        document.getElementById(\"confirmModal\").style.display = \"flex\";\n        return;\n    }\n\n    /* ===== Äá»– XE Má»šI ===== */\n    if (!detectedPlate) {\n        alert(\"Please scan license plate first!\");\n        return;\n    }\n\n    const existed = isVehicleAlreadyParked(detectedPlate);\n    if (existed) {\n        alert(`Vehicle already parked!\\nZone: ${existed.zone}\\nSlot: ${existed.slot}`);\n        return;\n    }\n\n    slot.occupied = true;\n    slot.startTime = Date.now();\n    slot.vehicle = currentVehicle;\n    slot.plate = detectedPlate;\n    activeSlot = slot;\n\n    vehicleInfo.textContent = `Vehicle: ${currentVehicle}`;\n    plateInfo.textContent = `Plate: ${detectedPlate}`;\n    statusText.textContent =\n        `Parking at ${zones[currentZone].name} - Slot ${slot.id}`;\n\n    vehicleImageEl.src = vehicleImages[currentVehicle];\n    vehicleImageEl.style.display = \"block\";\n\n    startTimer();\n\n    /* ðŸ”¥ CLEAR BIá»‚N Sá» Äá»‚ QUÃ‰T XE KHÃC */\n    detectedPlate = null;\n    document.getElementById(\"plateText\").textContent = \"â€”\";\n\n    renderSlots();\n}\n\n\nfunction isVehicleAlreadyParked(plate) {\n    for (const zoneKey in zones) {\n        const slots = zones[zoneKey].slots;\n        for (const slot of slots) {\n            if (slot.occupied && slot.plate === plate) {\n                return {\n                    zone: zones[zoneKey].name,\n                    slot: slot.id\n                };\n            }\n        }\n    }\n    return null;\n}\n\n/* ===================== ZONE DROPDOWN ===================== */\nselected.onclick = () => customSelect.classList.toggle(\"open\");\n\noptions.forEach(option => {\n    option.onclick = () => {\n        currentZone = option.dataset.zone;\n        selected.innerHTML = option.textContent + '<span class=\"arrow\">â–¾</span>';\n        customSelect.classList.remove(\"open\");\n\n        stopTimer();\n        renderZoneButtons();\n        renderSlots();\n    };\n});\n\ndocument.addEventListener(\"click\", e => {\n    if (!customSelect.contains(e.target)) {\n        customSelect.classList.remove(\"open\");\n    }\n});\n\n/* ===================== TIMER ===================== */\nfunction startTimer() {\n    clearInterval(timerInterval);\n\n    timerInterval = setInterval(() => {\n        if (!activeSlot) return;\n\n        const diff = Math.floor((Date.now() - activeSlot.startTime) / 1000);\n        const min = String(Math.floor(diff / 60)).padStart(2, \"0\");\n        const sec = String(diff % 60).padStart(2, \"0\");\n\n        timerText.textContent = `Time: ${min}:${sec}`;\n        priceText.textContent =\n            `Price: ${calculatePrice(Math.floor(diff / 60))} VND`;\n    }, 1000);\n}\n\nfunction stopTimer() {\n    clearInterval(timerInterval);\n    timerText.textContent = \"Time: 00:00\";\n    priceText.textContent = \"Price: 0 VND\";\n}\n\n/* ===================== CAMERA / SCAN ===================== */\ndocument.getElementById(\"parkBtn\").onclick = () => openCamera();\n\nfunction openCamera() {\n    detectedPlate = generatePlate();\n    document.getElementById(\"cameraModal\").style.display = \"flex\";\n}\n\nfunction generatePlate() {\n    const letters = \"ABCDEFGH\";\n    const nums = Math.floor(1000 + Math.random() * 9000);\n    return `51${letters[Math.floor(Math.random() * letters.length)]}-${nums}`;\n}\n\nfunction confirmPlate() {\n    document.getElementById(\"cameraModal\").style.display = \"none\";\n    document.getElementById(\"plateText\").textContent = detectedPlate;\n}\n\n/* ===================== QR BILL ===================== */\nfunction showQRBill(data) {\n    const modal = document.getElementById(\"qrModal\");\n    const qrDiv = document.getElementById(\"qrCode\");\n    const info = document.getElementById(\"billInfo\");\n\n    qrDiv.innerHTML = \"\";\n\n    const billText = `\n    Zone: ${data.zone}\n    Slot: ${data.slot}\n    Vehicle: ${data.vehicle}\n    Plate: ${data.plate}\n    Time: ${data.time} minutes\n    Price: ${data.price} VND\n    `;\n\n    new QRCode(qrDiv, {\n        text: billText,\n        width: 160,\n        height: 160\n    });\n\n    info.innerText = billText;\n    modal.style.display = \"flex\";\n}\n\ndocument.getElementById(\"continueBtn\").onclick = () => {\n    document.getElementById(\"confirmModal\").style.display = \"none\";\n    pendingSlot = null;\n};\n\ndocument.getElementById(\"leaveBtn\").onclick = () => {\n    document.getElementById(\"confirmModal\").style.display = \"none\";\n\n    if (!pendingSlot) return;\n\n    const minutes = Math.floor((Date.now() - pendingSlot.startTime) / 60000);\n    const price = calculatePrice(minutes);\n\n    showQRBill({\n        zone: zones[currentZone].name,\n        slot: pendingSlot.id,\n        vehicle: pendingSlot.vehicle,\n        plate: pendingSlot.plate,\n        time: minutes,\n        price\n    });\n\n    stopTimer();\n\n    pendingSlot.occupied = false;\n    pendingSlot.startTime = null;\n    pendingSlot.vehicle = null;\n    pendingSlot.plate = null;\n\n    activeSlot = null;\n    pendingSlot = null;\n\n    vehicleInfo.textContent = \"Vehicle: â€”\";\n    plateInfo.textContent = \"Plate: â€”\";\n    statusText.textContent = \"Select a slot\";\n    vehicleImageEl.style.display = \"none\";\n\n    renderSlots();\n};\n\n\nfunction closeQR() {\n    document.getElementById(\"qrModal\").style.display = \"none\";\n}\n\n/* ===================== INIT ===================== */\nrenderZoneButtons();\nrenderSlots();\n\n"]}