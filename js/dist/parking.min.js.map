{"version":3,"sources":["parking.js"],"names":["grid","document","getElementById","customSelect","options","querySelectorAll","vehicleInfo","plateInfo","statusText","timerText","zoneSelector","freeCountEl","busyCountEl","vehicleImageEl","activeSlot","timerInterval","detectedPlate","currentVehicle","vehicleImages","motorbike","bike","message","notif","style","display","textContent","closeNotification","Object","zones","btn","className","forEach","zoneKey","currentZone","name","classList","add","renderSlots","renderZoneButtons","appendChild","busy","slots","free","occupied","innerHTML","slot","createElement","id","div","onclick","handleSlotClick","updateZoneInfo","existed","isVehicleAlreadyParked","showNotification","concat","zone","price","showQRBill","minutes","Math","floor","Date","now","startTime","vehicle","plate","stopTimer","src","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","err","option","remove","min","String","diff","padStart","sec","calculatePrice","startTimer","clearInterval","setInterval","priceText","openCamera","generatePlate","nums","random","letters","length","modal","qrDiv","billText","data","confirmPlate","time","QRCode","info","text","closeQR","innerText","opt","o","dataset","type","selected","toggle","addEventListener","e","contains","target"],"mappings":"aACA,IAAMA,KAAOC,SAASC,eAAe,eADrCC,aAAAF,SAAAC,eAAA,cACMF,SAAOC,aAASC,cAAe,aAC/BC,QAAYA,aAAYD,iBAAe,eAEvCE,YAAUD,SAAaE,eAAiB,eAExCC,UAAcL,SAASC,eAAe,aACtCK,WAAYN,SAASC,eAAe,UACpCM,UAAaP,SAASC,eAAe,SACrCO,UAAYR,SAASC,eAAe,SAGpCQ,aAAeT,SAASC,eAAe,gBACvCS,YAAcV,SAASC,eAAe,aACtCU,YAAcX,SAASC,eAAe,aAI5CW,eAAAZ,SAAAC,eAAA,gBAEIY,YAAa,IACbC,WAAa,KACbC,cAAgB,KAChBC,cAAc,KAElBA,eAAA,MAEOC,cAAE,CACLC,IAAAA,0BACAC,UAAM,gCAHVA,KAAA,4BAoBInB,SAAAA,iBAAwBoB,GACxBC,IAAMC,EAAMC,SAAUtB,eAAtB,sBACHD,SAAAC,eAAA,gBAAAuB,YAAAJ,EADGC,EAAMC,MAAMC,QAAU,QAKzB,SAAAE,oBAEDzB,SAAAC,eAAA,sBAAAqB,MAAAC,QAAA,OAEId,SAAAA,oBAEAiB,aAAYC,UAAe,GAEvBC,OAAIC,KAAAA,OAAYC,QAAhB,SAAAC,GACIP,IAAAA,EAAJxB,SAAwB+B,cAAxB,UAEIA,EAAAA,UAAYC,WAFhBJ,EAAIJ,YAAcG,MAAMI,GAASE,KAK7BD,IAAcD,aAAdH,EAAAM,UAAAC,IAAA,UAEAC,EAAAA,QAAW,WAHfJ,YAAAD,EAEIM,oBAIJ5B,eAAAA,aAAa6B,YAAYV,KAM7B,SAAcW,iBAEdC,IAAMV,EAAQH,MAAAK,aAACQ,MAAAC,EAAMC,EAAAA,EAAWH,EAEhC7B,EAAAA,QAAYc,SAAAA,GAAAA,OAAAA,EAAZkB,SAAAH,IAAAE,MAEH/B,YAAAc,YAAAiB,EAED9B,YAAAa,YAAAe,EAEIxC,SAAK4C,cACL5C,KAAMyC,UAAcR,GAENL,MAAAK,aAAQQ,MAEdX,QAAJ,SAAAe,GACIpB,IAAAA,EAAJxB,SAAA6C,cAA+BC,OAD/BC,EAAIlB,UAAY,SAAWe,EAAKF,SAAW,OAAS,QAEhDM,EAAAA,YAAAA,QAAAA,OAAUJ,EAAAE,IAAAC,EAAAC,QAAMC,WAAAA,OAAeA,gBAArBL,IAAd7C,KAAAuC,YAAAS,KAJJG,iBAYJ,SAASD,gBAAgBL,GAKrB,GAAA7B,cAAA,CAMA,IAAMoC,EAAUC,uBAAuBrC,eAAvC,GAAMoC,EAEHE,iBAAgB,kCAAAC,OAAmCH,EAAQI,KAA3C,YAAAD,OAA0DH,EAAQP,WAFrF,CAIC,GAAAA,EAAAF,SAuBSc,CAENC,IAAUC,EAACC,KAAAC,OAAAC,KAAAC,MAAAlB,EAAAmB,WAAA,KACDpC,EAAMK,eADL0B,GAGPM,WAAa,CACRT,KAAOU,MAJLjC,aAAAC,KAKDyB,KAAAA,EALCZ,GAMFkB,QAALR,EAAAA,QANJS,MAAArB,EAAAqB,MASAC,KAASR,EAEJhB,MAAAA,IAGDwB,YAIJ7D,EAAAA,UAAYmB,EACZlB,EAASyD,UAAT,KACAxD,EAAAA,QAAWiB,KACXZ,EAAAA,MAAeU,KAElBP,cAAA,KAEDqB,YAAWZ,YAAA,aACdlB,UAAAkB,YAAA,WANOjB,WAAWiB,YAAc,gBAQjCZ,eAASwC,MAAAA,QAA8B,OAC9BpD,SAAM+B,eAAkB,aAAAP,YAAA,QAtD5B,CAEIoB,EAAKF,UAAU,EAEZE,EAACF,UAALmB,KAAAC,MACIlB,EAACmB,QAAYF,eACbjB,EAACoB,MAAUhD,cACXH,WAASE,EAGbV,YAAYmB,YAAZnB,YAAAA,OAAAW,gBACAV,UAAUkB,YAAVlB,UAAAA,OAAAS,eACAR,WAAWiB,YAAXjB,cAAAA,OAGqBU,MAAAA,aAAcD,KAHnCT,YAAAA,OAGAqC,EAAAE,IAAAlC,eAAeuD,IAAMlD,cAAcD,gBAE7BmC,eAAUC,MAAAA,QAAAA,QAAAA,uBAAuBrC,eAKjC2C,aAgCmBtB,oBA/DxBrB,iBAAe,oCA+DS,SAAAqC,uBAAAa,GAEzB,IAAA,IAAAlC,KAAAJ,MAAA,CAA0B,IAAfiB,EAAejB,MAAAI,GAAAS,MAA1B4B,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAAA,IAAA,IAAAC,EAAAC,EAAmBjC,EAAnBkC,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAC,MAAAT,GAAA,EAA0B,CAAA,IAAfxB,EAAe4B,EAAAM,MAClBlC,GAAIA,EAACF,UAAgBE,EAACqB,QAAUA,EAChC,MAAO,CACGtC,KAAMI,MAANA,GADHE,KAEGW,KAAKE,EAAAA,KAJvB,MAAAiC,GAAAV,GAAA,EAAAC,EAAAS,EAAA,QAAA,IAAAX,GAAA,MAAAK,EAAA,QAAAA,EAAA,SAAA,QAAA,GAAAJ,EAAA,MAAAC,IAFyB,OAAA,KAkB7BU,SAAOhC,aACHhB,cAAcgD,eAEd9E,cAAagC,YAAU+C,WAEvBf,GAASrD,WAATqD,CAEA9B,IAAAA,EAAWuB,KAAAC,OAAAC,KAAAC,MAAAjD,WAAAkD,WAAA,KAPfmB,EAAAC,OAAAxB,KAAAC,MAAAwB,EAAA,KAAAC,SAAA,EAAA,KADJC,EAAAH,OAAAC,EAAA,IAAAC,SAAA,EAAA,KAaSnF,UAAAA,YAAAA,SAAAA,OAAiCgF,EAAjChF,KAAAA,OAAiCoF,GAClCpF,UAAagC,YAAbhC,UAAAA,OACHqF,eAAA5B,KAAAC,MAAAwB,EAAA,KADGlF,UAFR,KAOA,SAASsF,YACLC,cAAc3E,eAEdA,UAAAA,YAAgB4E,cACZC,UAAK9E,YAAY,eASpB,SAV0B+E,aAW9B7E,cAAA8E,gBAaG7F,SAASC,eAAe,eAAeqB,MAAMC,QAAU,OATvDf,SAAAA,gBACAmF,IAAAA,EAAUnE,WACbsE,EAAAnC,KAAAC,MAAA,IAAA,IAAAD,KAAAoC,UAED,MAAA,KAAAzC,OAAA0C,EAAArC,KAAAC,MAAAD,KAAAoC,SAAAC,EAAAC,SAAA,KAAA3C,OAAAwC,GACA9F,SAASC,eAAoCD,SAAM4F,eAAN,eAAAtE,MAAAC,QAAA,OAA7CvB,SAAAC,eAAA,aAAAuB,YAAAT,cAIIf,SAAAA,WAASC,GACZ,IAAAiG,EAAAlG,SAAAC,eAAA,WAgBSkG,EAAQnG,SAASC,eAAe,UAdjC4F,EAAAA,SAAgB5F,eAAA,YAErBkG,EAAUxD,UAAQiB,GAErB,IAAAwC,EAAA,WAAA9C,OAgBO+C,EAAK9C,KAhBZ,YAAAD,OAED+C,EAASC,KAFR,eAAAhD,OAGYrD,EAAAA,QAHZ,aAAAqD,OAIGtD,EAASC,MAJZ,YAAAqD,OAKA+C,EAAAE,KALA,qBAAAjD,OAOD+C,EAAA7C,MAPC,UAQD,IAAAgD,OAAS/C,EAAW4C,CACVH,KAAQlG,EACRmG,MAAQnG,IACRyG,OAAOzG,MAabyG,EAAID,UAAcJ,EACdM,EAAMN,MAAAA,QADQ,OAAA,SAAlBO,UAMAF,SAAKG,eAAL,WAAAtF,MAAAC,QAAA,OA7OAsF,SAAI7D,iBAAU,mBAAMlB,QAAA,SAAA+E,GAChB7G,EAAAA,QACKI,WACSJ,SAFdI,iBAAA,mBAII8B,QAAJ,SAAA4E,GAAkB,OAAAA,EAAA5E,UAAlB+C,OAAA,YALJ4B,EAAA3E,UAAAC,IAAA,UADJnB,eAAA6F,EAAAE,QAAAC,QA0IiCC,SAAAjE,QAAA,WAAA,OAAA9C,aAAAgC,UAAAgF,OAAA,SAAA/G,QAAA2B,QAAA,SAAAkD,GAAAA,EAAAhC,QAAA,WAAAhB,YAAAgD,EAAA+B,QAAAxD,KAAA0D,SAAAtE,UAAAqC,EAAAxD,YAAA,+BAAAtB,aAAAgC,UAAA+C,OAAA,QAAAf,YAU5B7B,oBAeGD,iBAIRpC,SAASmH,iBAAiB,QAAS,SAAAC,GAC1BlH,aAAamH,SAASD,EAAEE,SAfzBpH,aAAWgC,UAAA+C,OAAA,UA+BXzE,SAAAA,eAAUgB,WAAVwB,QAAiCkC,WAAAA,OAAjCU,cA0DRvD,oBACIrC","file":"parking.min.js","sourcesContent":["/* ===================== DOM ===================== */\nconst grid = document.getElementById(\"parkingGrid\");\nconst customSelect = document.getElementById(\"zoneSelect\");\nconst selected = customSelect.querySelector(\".selected\");\nconst options = customSelect.querySelectorAll(\".options li\");\n\nconst vehicleInfo = document.getElementById(\"vehicleInfo\");\nconst plateInfo = document.getElementById(\"plateInfo\");\nconst statusText = document.getElementById(\"status\");\nconst timerText = document.getElementById(\"timer\");\nconst priceText = document.getElementById(\"price\");\n\nconst zoneSelector = document.getElementById(\"zoneSelector\");\nconst freeCountEl = document.getElementById(\"freeCount\");\nconst busyCountEl = document.getElementById(\"busyCount\");\n\nconst vehicleImageEl = document.getElementById(\"vehicleImage\");\n\n/* ===================== STATE ===================== */\nlet currentZone = \"A\";\nlet activeSlot = null;\nlet timerInterval = null;\nlet detectedPlate = null;\nlet currentVehicle = \"car\";\n\n/* ===================== DATA ===================== */\nconst vehicleImages = {\n    car: \"assets/vehicles/car.png\",\n    motorbike: \"assets/vehicles/motorbike.png\",\n    bike: \"assets/vehicles/bike.png\"\n};\n\n/* ===================== VEHICLE SELECT ===================== */\ndocument.querySelectorAll(\".vehicle-option\").forEach(opt => {\n    opt.onclick = () => {\n        document\n            .querySelectorAll(\".vehicle-option\")\n            .forEach(o => o.classList.remove(\"active\"));\n\n        opt.classList.add(\"active\");\n        currentVehicle = opt.dataset.type;\n    };\n});\n\nfunction showNotification(message) {\n    const notif = document.getElementById(\"systemNotification\");\n    document.getElementById(\"notifMessage\").textContent = message;\n    notif.style.display = \"block\";\n}\n\nfunction closeNotification() {\n    document.getElementById(\"systemNotification\").style.display = \"none\";\n}\n\n/* ===================== ZONE ===================== */\nfunction renderZoneButtons() {\n    zoneSelector.innerHTML = \"\";\n\n    Object.keys(zones).forEach(zoneKey => {\n        const btn = document.createElement(\"button\");\n        btn.className = \"zone-btn\";\n        btn.textContent = zones[zoneKey].name;\n\n        if (zoneKey === currentZone) btn.classList.add(\"active\");\n\n        btn.onclick = () => {\n            currentZone = zoneKey;\n            renderZoneButtons();\n            renderSlots();\n        };\n\n        zoneSelector.appendChild(btn);\n    });\n}\n\nfunction updateZoneInfo() {\n    const slots = zones[currentZone].slots;\n    let free = 0, busy = 0;\n\n    slots.forEach(s => s.occupied ? busy++ : free++);\n\n    freeCountEl.textContent = free;\n    busyCountEl.textContent = busy;\n}\n\n/* ===================== PARKING GRID ===================== */\nfunction renderSlots() {\n    grid.innerHTML = \"\";\n    const slots = zones[currentZone].slots;\n\n    slots.forEach(slot => {\n        const div = document.createElement(\"div\");\n        div.className = \"slot \" + (slot.occupied ? \"busy\" : \"free\");\n        div.textContent = `Slot ${slot.id}`;\n        div.onclick = () => handleSlotClick(slot);\n        grid.appendChild(div);\n    });\n\n    updateZoneInfo();\n}\n\n/* ===================== SLOT CLICK ===================== */\nfunction handleSlotClick(slot) {\n\n    // if (!slot.occupied && !detectedPlate) {\n    //     alert(\"Please scan license plate first!\");\n    //     return;\n    // }\n    if (!detectedPlate) {\n           showNotification(\"Please scan vehicle plate first!\");\n            return;\n    }\n\n    const existed = isVehicleAlreadyParked(detectedPlate);\n    if (existed) {\n       showNotification(`Vehicle already parked!\\nZone: ${existed.zone}\\nSlot: ${existed.slot}`);\n        return;\n    }\n\n    if (!slot.occupied) {\n        \n        slot.occupied = true;\n        slot.startTime = Date.now();\n        slot.vehicle = currentVehicle;\n        slot.plate = detectedPlate;\n        activeSlot = slot;\n\n        vehicleInfo.textContent = `Vehicle: ${currentVehicle}`;\n        plateInfo.textContent = `Plate: ${detectedPlate}`;\n        statusText.textContent =\n            `Parking at ${zones[currentZone].name} - Slot ${slot.id}`;\n\n        vehicleImageEl.src = vehicleImages[currentVehicle];\n        vehicleImageEl.style.display = \"block\";\n        const existed = isVehicleAlreadyParked(detectedPlate);\n      \n\n        startTimer();\n    } else {\n        const minutes = Math.floor((Date.now() - slot.startTime) / 60000);\n        const price = calculatePrice(minutes);\n\n        showQRBill({\n            zone: zones[currentZone].name,\n            slot: slot.id,\n            vehicle: slot.vehicle,\n            plate: slot.plate,\n            time: minutes,\n            price\n        });\n\n        stopTimer();\n\n        slot.occupied = false;\n        slot.startTime = null;\n        slot.vehicle = null;\n        slot.plate = null;\n\n        detectedPlate = null;\n\n        vehicleInfo.textContent = \"Vehicle: —\";\n        plateInfo.textContent = \"Plate: —\";\n        statusText.textContent = \"Select a slot\";\n        vehicleImageEl.style.display = \"none\";\n        document.getElementById(\"plateText\").textContent = \"—\";\n    }\n\n    renderSlots();\n}\n\nfunction isVehicleAlreadyParked(plate) {\n    for (const zoneKey in zones) {\n        const slots = zones[zoneKey].slots;\n        for (const slot of slots) {\n            if (slot.occupied && slot.plate === plate) {\n                return {\n                    zone: zones[zoneKey].name,\n                    slot: slot.id\n                };\n            }\n        }\n    }\n    return null;\n}\n\n/* ===================== ZONE DROPDOWN ===================== */\nselected.onclick = () => customSelect.classList.toggle(\"open\");\n\noptions.forEach(option => {\n    option.onclick = () => {\n        currentZone = option.dataset.zone;\n        selected.innerHTML = option.textContent + '<span class=\"arrow\">▾</span>';\n        customSelect.classList.remove(\"open\");\n\n        stopTimer();\n        renderZoneButtons();\n        renderSlots();\n    };\n});\n\ndocument.addEventListener(\"click\", e => {\n    if (!customSelect.contains(e.target)) {\n        customSelect.classList.remove(\"open\");\n    }\n});\n\n/* ===================== TIMER ===================== */\nfunction startTimer() {\n    clearInterval(timerInterval);\n\n    timerInterval = setInterval(() => {\n        if (!activeSlot) return;\n\n        const diff = Math.floor((Date.now() - activeSlot.startTime) / 1000);\n        const min = String(Math.floor(diff / 60)).padStart(2, \"0\");\n        const sec = String(diff % 60).padStart(2, \"0\");\n\n        timerText.textContent = `Time: ${min}:${sec}`;\n        priceText.textContent =\n            `Price: ${calculatePrice(Math.floor(diff / 60))} VND`;\n    }, 1000);\n}\n\nfunction stopTimer() {\n    clearInterval(timerInterval);\n    timerText.textContent = \"Time: 00:00\";\n    priceText.textContent = \"Price: 0 VND\";\n}\n\n/* ===================== CAMERA / SCAN ===================== */\ndocument.getElementById(\"parkBtn\").onclick = () => openCamera();\n\nfunction openCamera() {\n    detectedPlate = generatePlate();\n    document.getElementById(\"cameraModal\").style.display = \"flex\";\n}\n\nfunction generatePlate() {\n    const letters = \"ABCDEFGH\";\n    const nums = Math.floor(1000 + Math.random() * 9000);\n    return `51${letters[Math.floor(Math.random() * letters.length)]}-${nums}`;\n}\n\nfunction confirmPlate() {\n    document.getElementById(\"cameraModal\").style.display = \"none\";\n    document.getElementById(\"plateText\").textContent = detectedPlate;\n}\n\n/* ===================== QR BILL ===================== */\nfunction showQRBill(data) {\n    const modal = document.getElementById(\"qrModal\");\n    const qrDiv = document.getElementById(\"qrCode\");\n    const info = document.getElementById(\"billInfo\");\n\n    qrDiv.innerHTML = \"\";\n\n    const billText = `\nZone: ${data.zone}\nSlot: ${data.slot}\nVehicle: ${data.vehicle}\nPlate: ${data.plate}\nTime: ${data.time} minutes\nPrice: ${data.price} VND\n`;\n\n    new QRCode(qrDiv, {\n        text: billText,\n        width: 160,\n        height: 160\n    });\n\n    info.innerText = billText;\n    modal.style.display = \"flex\";\n}\n\nfunction closeQR() {\n    document.getElementById(\"qrModal\").style.display = \"none\";\n}\n\n/* ===================== INIT ===================== */\nrenderZoneButtons();\nrenderSlots();\n\n"]}